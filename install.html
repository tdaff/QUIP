<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installation of QUIP and quippy &mdash; quippy ac3573e documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'ac3573e',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="quippy ac3573e documentation" href="index.html" />
    <link rel="next" title="Examples" href="Examples/index.html" />
    <link rel="prev" title="Introduction to quippy" href="intro.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Examples/index.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction to quippy"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">quippy ac3573e documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/hybrid.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installation of QUIP and quippy</a><ul>
<li><a class="reference internal" href="#quick-start">Quick start</a></li>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#getting-quippy">Getting quippy</a></li>
<li><a class="reference internal" href="#configuring-quippy">Configuring quippy</a><ul>
<li><a class="reference internal" href="#custom-settings">Custom settings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compilation">Compilation</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#id2">Installation</a></li>
<li><a class="reference internal" href="#common-problems">Common Problems</a><ul>
<li><a class="reference internal" href="#permission-errors-when-installing">Permission errors when installing</a></li>
<li><a class="reference internal" href="#installating-on-mac-os-x-with-macports">Installating on Mac OS X with macports</a></li>
<li><a class="reference internal" href="#runtimeerror-when-importing">RuntimeError when importing</a></li>
<li><a class="reference internal" href="#importerror-when-importing">ImportError when importing</a></li>
<li><a class="reference internal" href="#possible-problems-installing-atomeye-module">Possible problems installing atomeye module</a></li>
<li><a class="reference internal" href="#error-compiling-ipmodel-gap">Error compiling IPModel_GAP</a></li>
<li><a class="reference internal" href="#warning-about-quippy-castep-when-importing-quippy">Warning about <code class="docutils literal"><span class="pre">quippy.castep</span></code> when importing quippy</a></li>
<li><a class="reference internal" href="#internal-compiler-error-with-ifort">Internal compiler error with <cite>ifort</cite></a></li>
<li><a class="reference internal" href="#linking-error-on-mac-os-x">Linking error on Mac OS X</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="intro.html"
                        title="previous chapter">Introduction to <code class="docutils literal"><span class="pre">quippy</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Examples/index.html"
                        title="next chapter">Examples</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/install.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="installation-of-quip-and-quippy">
<span id="installation"></span><h1>Installation of QUIP and quippy<a class="headerlink" href="#installation-of-quip-and-quippy" title="Permalink to this headline">¶</a></h1>
<p>These intructions provide more details on the compilation and
installation of <cite>QUIP</cite> (Fortran library and main programs) and
<cite>quippy</cite> (Python interface). They should be read in conjunction with
the main <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/README.md">README</a>.</p>
<div class="section" id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>For people who don&#8217;t read manuals:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git clone https://github.com/libAtoms/QUIP.git
$ cd QUIP
$ export QUIP_ARCH=linux_x86_64_gfortran
$ make config
$ make
$ make quippy
$ make install-quippy
</pre></div>
</div>
<p>Then add the installation directory to your <span class="target" id="index-0"></span><a class="reference external" href="http://docs.python.org/2.7/using/cmdline.html#envvar-PYTHONPATH" title="(in Python v2.7)"><code class="xref std std-envvar docutils literal"><span class="pre">PYTHONPATH</span></code></a>.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Essential:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="http://www.python.org">Python 2.6</a> or later</li>
<li><a href="#id3"><span class="problematic" id="id4">`numpy`_</span></a>  - version 1.2.1 or later</li>
<li>A working fortran compiler:<ul>
<li>ifort 10 or later (tested with 10.1.015 and 11.0.084)</li>
<li>gfortran 4.3.3 or later</li>
<li>Others that should work but haven&#8217;t been tested: <cite>pathf95</cite>, <cite>g95</cite>, <cite>pgf95</cite>, <cite>xlf95</cite></li>
</ul>
</li>
</ul>
</dd>
<dt>Optional:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="http://ipython.scipy.org">ipython</a> makes using python interactively
much more productive.</li>
<li><a class="reference external" href="http://matplotlib.sourceforge.net">matplotlib</a> is a useful plotting library which integrates well with ipython</li>
<li><a class="reference external" href="http://mt.seas.upenn.edu/Archive/Graphics/A3/A3.html">AtomEye</a>
atomistic configuration viewer.  A modified version of AtomEye
which integrates with quippy is available from my <a class="reference external" href="https://www.github.com/jameskermode/AtomEye">GitHub
repository</a></li>
<li><a class="reference external" href="http://www.scipy.org">scipy</a> provides more scientific
functionality e.g. least squares fitting, optimisation, etc.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="getting-quippy">
<h2>Getting quippy<a class="headerlink" href="#getting-quippy" title="Permalink to this headline">¶</a></h2>
<p>You can download QUIP and quippy from our public <a class="reference external" href="https://www.github.com/libAtoms/QUIP">GitHub repository</a></p>
<div class="highlight-python"><div class="highlight"><pre>git clone https://github.com/libAtoms/QUIP.git
</pre></div>
</div>
<p>We&#8217;ll use the environment variable <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal"><span class="pre">QUIP_ROOT</span></code> to refer
to the root of the QUIP tree:</p>
<div class="highlight-python"><div class="highlight"><pre>export QUIP_ROOT=~/QUIP/
</pre></div>
</div>
<p>The <code class="file docutils literal"><span class="pre">libAtoms</span></code>, <code class="file docutils literal"><span class="pre">QUIP_Core</span></code>, <code class="file docutils literal"><span class="pre">QUIP_Util</span></code> and
<code class="file docutils literal"><span class="pre">QUIP_Programs</span></code> directories contain Fortran 95 source
code. quippy itself lives in the <code class="file docutils literal"><em><span class="pre">QUIP_ROOT</span></em><span class="pre">/Tools/quippy</span></code>
directory.</p>
</div>
<div class="section" id="configuring-quippy">
<h2>Configuring quippy<a class="headerlink" href="#configuring-quippy" title="Permalink to this headline">¶</a></h2>
<p>Before compiling quippy, you need to set the environment variable
<span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal"><span class="pre">QUIP_ARCH</span></code>. This sets the architecture for the QUIP framework which
quippy wraps. Architectures are defined by creating a file
<code class="file docutils literal"><span class="pre">$</span><em><span class="pre">QUIP_ROOT</span></em><span class="pre">/Makefiles/Makefile.$</span><em><span class="pre">QUIP_ARCH</span></em></code> which describes which
compilers and libraries should be used and where they can be found. quippy has
been tested on the following architectures:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">darwin_x86_64_gfortran</span>
<span class="n">linux_x86_64_gfortran</span>
<span class="n">linux_x86_64_ifort_gcc_serial</span>
<span class="n">linux_x86_64_pgi</span>
</pre></div>
</div>
<p>If you&#8217;re on one of these platforms then just set <span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal"><span class="pre">QUIP_ARCH</span></code>
appropriately, for example on 64-bit Mac OS X with gfortran you would
do:</p>
<div class="highlight-python"><div class="highlight"><pre>$ export QUIP_ARCH=darwin_x86_64_gfortran
</pre></div>
</div>
<p>Otherwise you&#8217;ll have to make a new <code class="file docutils literal"><span class="pre">Makefile.$</span><em><span class="pre">QUIP_ARCH</span></em></code>,
containing some of the variables defined below. The next step is to
answer a number of questions about your system:</p>
<div class="highlight-python"><div class="highlight"><pre>$ make config
</pre></div>
</div>
<p>This generates a configurtion file <cite>build/${QUIP_ARCH}/Makefile.inc</cite>
which you can subsequently edit if you need to customize any of the
options described below.</p>
<div class="section" id="custom-settings">
<h3>Custom settings<a class="headerlink" href="#custom-settings" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong class="makevar">MATHS_LINKOPTS</strong></dt>
<dd><p class="first">Library options needed to link to BLAS and LAPACK libraries. Any working
BLAS/LAPACK installation is fine. If you are using Linux, ATLAS is
a good option, and you should use something like the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">atlas</span> <span class="o">-</span><span class="n">llapack</span> <span class="o">-</span><span class="n">lf77blas</span> <span class="o">-</span><span class="n">lcblas</span> <span class="o">-</span><span class="n">latlas</span>
</pre></div>
</div>
<p>On Mac OS X, there are build in LAPACK libraries in the Accelerate
framework, which you can use by entering</p>
<blockquote class="last">
<div>-framework Accelerate</div></blockquote>
</dd>
<dt><strong class="makevar">FOX_LIBDIR</strong>, <strong class="makevar">FOX_INCDIR</strong> and <strong class="makevar">FOX_LIBS</strong></dt>
<dd>Directories containing FoX libraries and header files, and required link options.
Should be read automatically from QUIP Makefiles.</dd>
<dt><strong class="makevar">QUIPPY_FCOMPILER</strong></dt>
<dd><p class="first">Fortran compiler to use. The shell command:</p>
<div class="highlight-python"><div class="highlight"><pre>$ f2py -c --help-fcompiler
</pre></div>
</div>
<p class="last">will print a list of detected compilers on your system. Use <code class="docutils literal"><span class="pre">gnu95</span></code> for gfortran,
<code class="docutils literal"><span class="pre">intel</span></code> for ifort on 32-bit platforms and <code class="docutils literal"><span class="pre">intelem</span></code> for ifort on 64-bit platforms.</p>
</dd>
<dt><strong class="makevar">QUIPPY_DEFINES</strong> Preprocessor macros which should be defined</dt>
<dd>when compiling quippy. Note that since the Fortran source files are
preprocessed <em>before</em> being scanned by <a class="reference internal" href="f90doc.html#module-f90doc" title="f90doc: Read Fortan 90 sources and extract documenataion strings"><code class="xref py py-mod docutils literal"><span class="pre">f90doc</span></code></a>, it&#8217;s
important to put all the <cite>-D</cite> options needed here and not in
<strong class="makevar">QUIPPY_F90FLAGS</strong>.</dd>
<dt><strong class="makevar">QUIPPY_F90FLAGS</strong> and <strong class="makevar">QUIPPY_F77FLAGS</strong></dt>
<dd>Extra flags to pass to Fortran 90 and 77 compilers</dd>
<dt><strong class="makevar">QUIPPY_OPT</strong></dt>
<dd>Optimisation settings for Fortran compiler</dd>
<dt><strong class="makevar">QUIPPY_DEBUG</strong></dt>
<dd>Set this to <cite>1</cite> to include debugging information in the compiled extension code.
This also disables optimisation.</dd>
<dt><strong class="makevar">QUIPPY_CPP</strong></dt>
<dd>Fortran preprocessor to use. Default is system <cite>cpp</cite>.</dd>
<dt><strong class="makevar">QUIPPY_INSTALL_OPTS</strong></dt>
<dd>Installation options, e.g. specify <code class="docutils literal"><span class="pre">--home=${HOME}</span></code>
or <code class="docutils literal"><span class="pre">--prefix=${PREFIX}</span></code> to install in a non-default location.</dd>
<dt><strong class="makevar">QUIPPY_NO_TOOLS</strong></dt>
<dd>If set to 1, omit compilation of extra tools such as the elasticity module.</dd>
<dt><strong class="makevar">QUIPPY_NO_CRACK</strong></dt>
<dd>If set to 1, omit compilation of crack utilities.</dd>
<dt><strong class="makevar">HAVE_NETCDF</strong></dt>
<dd>Should be set to 1 to enable NetCDF support. Should be read automatically from QUIP.</dd>
<dt><strong class="makevar">NETCDF4</strong></dt>
<dd>If set to 1, use version 4 of NetCDF. Should be read automatically from QUIP.</dd>
<dt><strong class="makevar">NETCDF_LIBDIR</strong>, <strong class="makevar">NETCDF_INCDIR</strong>, <strong class="makevar">NETCDF_LIBS</strong> and <strong class="makevar">NETCDF4_LIBS</strong></dt>
<dd>Directories containing NetCDF libraries and header files, and required link options.
Should be read automatically from QUIP.</dd>
</dl>
</div>
</div>
<div class="section" id="compilation">
<h2>Compilation<a class="headerlink" href="#compilation" title="Permalink to this headline">¶</a></h2>
<p>It&#8217;s best to compile QUIP before trying to compile quippy. This will
compile the FoX Fortran XML library as well as generating the required
Makefiles. To compile QUIP, run <cite>make</cite> from the <span class="target" id="index-4"></span><code class="xref std std-envvar docutils literal"><span class="pre">QUIP_ROOT</span></code>
directory after setting <span class="target" id="index-5"></span><code class="xref std std-envvar docutils literal"><span class="pre">QUIP_ARCH</span></code> appropriately, e.g.</p>
<div class="highlight-python"><div class="highlight"><pre>cd ${QUIP_ROOT}
export QUIP_ARCH=linux_x86_64_gfortran
make
</pre></div>
</div>
<p>After this, it&#8217;s time to compile quippy itself</p>
<div class="highlight-python"><div class="highlight"><pre>make quippy
</pre></div>
</div>
<p>to compile quippy. The compilation process is quite long; here is an
overview of the various steps that are performed.</p>
<ul class="simple">
<li><code class="xref py py-mod docutils literal"><span class="pre">patch_f2py</span></code> is invoked to patch the <code class="xref py py-mod docutils literal"><span class="pre">numpy.f2py</span></code>
package at runtime to make several changes to the f2py-generated
C code. This will fail if you don&#8217;t have <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/index.html#module-numpy" title="(in NumPy v1.10)"><code class="xref py py-mod docutils literal"><span class="pre">numpy</span></code></a> 1.2.1 or
later.</li>
<li>Fortran sources are imported from the <code class="file docutils literal"><span class="pre">libAtoms</span></code>, <code class="file docutils literal"><span class="pre">QUIP_Core</span></code>,
<code class="file docutils literal"><span class="pre">QUIP_Utils</span></code> (if <strong class="makevar">QUIPPY_NO_TOOLS</strong> is not set)
and <code class="file docutils literal"><span class="pre">QUIP_Programs</span></code> (if <strong class="makevar">QUIPPY_NO_CRACK</strong> is not set)
directories. At this stage the sources are preprocessed with the
<strong class="makevar">QUIPPY_CPP</strong> preprocessor. This removes <code class="docutils literal"><span class="pre">#ifdef</span></code> sections
so that the tools which read the Fortran source do not get confused
by multiple version of routines.</li>
<li>The <a class="reference internal" href="f90doc.html#module-f90doc" title="f90doc: Read Fortan 90 sources and extract documenataion strings"><code class="xref py py-mod docutils literal"><span class="pre">f90doc</span></code></a> module is used to parse Fortran sources and
analyse all the types, subroutines and functions.</li>
<li>Using the definitions read by <a class="reference internal" href="f90doc.html#module-f90doc" title="f90doc: Read Fortan 90 sources and extract documenataion strings"><code class="xref py py-mod docutils literal"><span class="pre">f90doc</span></code></a>, the
<a class="reference internal" href="f2py_wrapper_gen.html#module-f2py_wrapper_gen" title="f2py_wrapper_gen: Generate simplified Fortran 90 source suitable for f2py"><code class="xref py py-mod docutils literal"><span class="pre">f2py_wrapper_gen</span></code></a> module writes a Fortran wrapper file for
each source file that we&#8217;re going to wrap. These files are named
<code class="file docutils literal"><span class="pre">quippy_$</span><em><span class="pre">STEM</span></em><span class="pre">_wrap.f90</span></code> and are designed to use the
restricted set of Fortran 90 features understood by f2py.</li>
<li>The <code class="file docutils literal"><span class="pre">quippy_$</span><em><span class="pre">STEM</span></em><span class="pre">_wrap.f90</span></code> files are passed to f2py, which
generates a Python extension module <code class="xref py py-mod docutils literal"><span class="pre">_quippy</span></code>. This is a low-level
module which allows all the Fortran functions to be called from Python,
but doesn&#8217;t know anything about derived-types. See <a class="reference internal" href="fortran_wrapper.html#wrapping-fortran-90-code"><span>Appendix: wrapping Fortran 90 Code</span></a>
for more details.</li>
<li>All the Fortran sources - both those imported and the generated
wrappers - are compiled using the Fortran compiler specified in
the <strong class="makevar">QUIPPY_FCOMPILER</strong> Makefile variable. The <code class="xref py py-mod docutils literal"><span class="pre">_quippy</span></code>
C extension module is also compiled.</li>
<li>Finally all the object files are linked, together with external
libraries such as NetCDF and LAPACK, to create
<code class="file docutils literal"><span class="pre">_quippy.so</span></code>, the Python extension module.</li>
</ul>
<p>If the compilation fails with an error message, please send the full
output to me at <a class="reference external" href="mailto:j&#46;r&#46;kermode&#37;&#52;&#48;warwick&#46;ac&#46;uk">j<span>&#46;</span>r<span>&#46;</span>kermode<span>&#64;</span>warwick<span>&#46;</span>ac<span>&#46;</span>uk</a> and I&#8217;ll do my best to work
out what&#8217;s going wrong.</p>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>Once quippy is successfully compiled, you should run the test suite to
check everything is working correctly:</p>
<div class="highlight-python"><div class="highlight"><pre>make test
</pre></div>
</div>
<p>The tests themselves can be found in <code class="file docutils literal"><span class="pre">$</span><em><span class="pre">QUIP_ROOT</span></em><span class="pre">/tests/test*.py</span></code>.
If any of the tests fail please send me (<a class="reference external" href="mailto:j&#46;r&#46;kermode&#37;&#52;&#48;warwick&#46;ac&#46;uk">j<span>&#46;</span>r<span>&#46;</span>kermode<span>&#64;</span>warwick<span>&#46;</span>ac<span>&#46;</span>uk</a>) the output.</p>
</div>
<div class="section" id="id2">
<h2>Installation<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Once all the tests have passed, run</p>
<div class="highlight-python"><div class="highlight"><pre>make install-quippy
</pre></div>
</div>
<p>to install in the standard place for Python extension modules on your
system (this will probably be something like
<code class="file docutils literal"><span class="pre">/usr/local/lib/python-2.</span><em><span class="pre">x</span></em><span class="pre">/site-packages</span></code>). To install
elsewhere, edit the <cite>Makefile.inc</cite> to include the line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">QUIPPY_INSTALL_OPTIONS</span><span class="o">=--</span><span class="n">prefix</span><span class="o">=</span><span class="n">PREFIX</span>
</pre></div>
</div>
<p>to install to a specific location such as <code class="file docutils literal"><span class="pre">/usr/local</span></code> or your
home directory. You will need to add the installation directory
containing the Python modules to your <span class="target" id="index-6"></span><a class="reference external" href="http://docs.python.org/2.7/using/cmdline.html#envvar-PYTHONPATH" title="(in Python v2.7)"><code class="xref std std-envvar docutils literal"><span class="pre">PYTHONPATH</span></code></a> environment
variable, e.g. by adding the following line your your <cite>~/.bashrc</cite> or
<cite>~/.profile</cite> file:</p>
<p>To test if the installation was successful, change out of the source
directory, start Python and try to import everything from the quippy
package:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd $HOME
$ python
&gt;&gt;&gt; from quippy import *
</pre></div>
</div>
<p>If you have any problems as this stage such as unresolved linking
dependencies, consult the list of <a class="reference internal" href="#install-faq"><span>Common Problems</span></a> below.</p>
</div>
<div class="section" id="common-problems">
<span id="install-faq"></span><h2>Common Problems<a class="headerlink" href="#common-problems" title="Permalink to this headline">¶</a></h2>
<div class="section" id="permission-errors-when-installing">
<h3>Permission errors when installing<a class="headerlink" href="#permission-errors-when-installing" title="Permalink to this headline">¶</a></h3>
<p>If you are installing as root, you may need to make sure the value of
the <span class="target" id="index-7"></span><code class="xref std std-envvar docutils literal"><span class="pre">QUIP_ARCH</span></code> gets through to the install script, e.g.</p>
<div class="highlight-python"><div class="highlight"><pre>sudo QUIP_ARCH=darwin_x86_64_gfortran make install-quippy
</pre></div>
</div>
</div>
<div class="section" id="installating-on-mac-os-x-with-macports">
<h3>Installating on Mac OS X with macports<a class="headerlink" href="#installating-on-mac-os-x-with-macports" title="Permalink to this headline">¶</a></h3>
<p>Macports requires various packages to be installed to compile
everything, and may require extra linking arguments. See the
<code class="file docutils literal"><span class="pre">README.macports</span></code> for the latest details.</p>
</div>
<div class="section" id="runtimeerror-when-importing">
<h3>RuntimeError when importing<a class="headerlink" href="#runtimeerror-when-importing" title="Permalink to this headline">¶</a></h3>
<p>If, after installing quippy, you get the error shown below when you
try to import it for the first time, then you are a victim of a bug in
early versions of Python 2.6.</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt;&gt; import quippy
Traceback (most recent call last):
 File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
 File &quot;/home/ab686/QUIP/Tools/quippy/quippy/__init__.py&quot;, line 31, in
&lt;module&gt;
   _quippy.system.verbosity_push(0)
RuntimeError: more argument specifiers than keyword list entries
(remaining format:&#39;|:_quippy.system.verbosity_push&#39;)
</pre></div>
</div>
<p>The solution is either to compile your own Python from the current svn
snapshot, or to update numpy to workaround the fix. This can be done
either by compiling numpy from source from an up-to-date svn snapshot,
or by applying <a class="reference external" href="http://projects.scipy.org/numpy/changeset/6193">the patch manually</a>.</p>
</div>
<div class="section" id="importerror-when-importing">
<h3>ImportError when importing<a class="headerlink" href="#importerror-when-importing" title="Permalink to this headline">¶</a></h3>
<p>If you get an <code class="xref py py-exc docutils literal"><span class="pre">ImportError</span></code> with a message about unresolved
dependancies then something went wrong with the linking process -
check that all the libraries you&#8217;re linking against are correct. You
can used <cite>ldd</cite> on Linux of <cite>otool -L</cite> on Mac OS X to check which
libraries the <code class="file docutils literal"><span class="pre">_quippy.so</span></code> Python extension is linked against.</p>
</div>
<div class="section" id="possible-problems-installing-atomeye-module">
<h3>Possible problems installing atomeye module<a class="headerlink" href="#possible-problems-installing-atomeye-module" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>If you get an <code class="xref py py-exc docutils literal"><span class="pre">ImportError</span></code> with a message ::</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomeye</span>
<span class="go">ImportError: dlopen(/Users/silvia/lib/python/_atomeye.so, 2): Symbol not found: _Config_load_libatoms</span>
<span class="go">Referenced from: /Users/silvia/lib/python/_atomeye.so</span>
<span class="go">Expected in: flat namespace</span>
<span class="go">in /Users/silvia/lib/python/_atomeye.so</span>
</pre></div>
</div>
</dd>
</dl>
<p>be sure that you have set <span class="target" id="index-8"></span><code class="xref std std-envvar docutils literal"><span class="pre">QUIP_ROOT</span></code> variable before starting the compilation.
If not make clean and recompile again</p>
<dl class="docutils">
<dt>If you get an <code class="xref py py-exc docutils literal"><span class="pre">ImportError</span></code> with a message ::</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomeye</span>
<span class="go">ImportError: dlopen(/Users/silvia/lib/python/_atomeye.so, 2): Symbol not found: __gfortran_adjustl</span>
<span class="go">Referenced from: /Users/silvia/lib/python/_atomeye.so</span>
<span class="go">Expected in: flat namespace</span>
<span class="go">in /Users/silvia/lib/python/_atomeye.so</span>
</pre></div>
</div>
</dd>
</dl>
<p>be sure that the gfortran libraries are properly set in <strong class="makevar">ATOMEYE_LIBS</strong> in Makefile.atomeye</p>
</div>
<div class="section" id="error-compiling-ipmodel-gap">
<h3>Error compiling IPModel_GAP<a class="headerlink" href="#error-compiling-ipmodel-gap" title="Permalink to this headline">¶</a></h3>
<p>If you get the following error during compilation:</p>
<div class="highlight-python"><div class="highlight"><pre>/QUIP/QUIP_Core/IPModel_GAP.f95:51.22:

use descriptors_module
                      1
Fatal Error: Can&#39;t open module file &#39;descriptors_module.mod&#39; for reading at (1): No such file or directory
</pre></div>
</div>
<p>The <cite>GAP_predict</cite> module is not publicly available, so the
<code class="file docutils literal"><span class="pre">Makefile.inc</span></code> must contain <strong class="makevar">HAVE_GP_PREDICT</strong> = 0, and
<strong class="makevar">HAVE_GP_TEACH</strong> = 0.</p>
</div>
<div class="section" id="warning-about-quippy-castep-when-importing-quippy">
<h3>Warning about <a class="reference internal" href="io.html#module-quippy.castep" title="quippy.castep: CASTEP file readers and writers"><code class="xref py py-mod docutils literal"><span class="pre">quippy.castep</span></code></a> when importing quippy<a class="headerlink" href="#warning-about-quippy-castep-when-importing-quippy" title="Permalink to this headline">¶</a></h3>
<p>If you get the following warning message when importin quippy:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python
&gt;&gt;&gt; from quippy import *
WARNING:root:quippy.castep import quippy.failed.
</pre></div>
</div>
<p>then don&#8217;t worry, the quippy.castep module is not redistributed with
the main code. The rest of quippy works fine without it.</p>
</div>
<div class="section" id="internal-compiler-error-with-ifort">
<h3>Internal compiler error with <cite>ifort</cite><a class="headerlink" href="#internal-compiler-error-with-ifort" title="Permalink to this headline">¶</a></h3>
<p>If you see an error like the following when using the Intel fortran compiler:</p>
<div class="highlight-python"><div class="highlight"><pre>fortcom: Severe: **Internal compiler error: internal abort** Please
report this error along with the circumstances in which it occurred
in a Software Problem Report.
 Note: File and line given may not be explicit cause of this error.

ifort: error #10014: problem during multi-file optimization compilation (code 3)
backend signals
</pre></div>
</div>
<p>Then the problem is due to bugs in the compiler. As a workaround,
setting <strong class="makevar">QUIPPY_NO_CRACK</strong> =1 in Makefile.inc should solve the
problem, at the cost of excluding the fracture utilities from quippy.</p>
</div>
<div class="section" id="linking-error-on-mac-os-x">
<h3>Linking error on Mac OS X<a class="headerlink" href="#linking-error-on-mac-os-x" title="Permalink to this headline">¶</a></h3>
<p>When recompiling quippy on top of a previous compilation, you may see
errors like this:</p>
<div class="highlight-python"><div class="highlight"><pre>collect2: ld returned 1 exit status ld: in
/QUIP/build.darwin_x86_64_gfortran/libquiputils.a, malformed
archive TOC entry for  ___elasticity_module_MOD_einstein_frequencies,
offset 1769103734 is beyond end of file 1254096
</pre></div>
</div>
<p>This seems to be a Mac OS X Lion problem with rebuilding static
libraries (.a files). Removing the static libraries with <cite>rm
../../build.${QUIP_ARCH}/*.a</cite> and recompiling should solve the
problem.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Examples/index.html" title="Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction to quippy"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">quippy ac3573e documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2008-2015, James Kermode.
      Last updated on Jan 14, 2016.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.4.
    </div>
  </body>
</html>